# Pydantic
- 2017年に誕生したばかりの、バリデーション（型チェック、書式チェック）を行うライブラリ
- Typingなどの最新のPythonバージョンと対応
- FastAPIなどの新しいフレームワークで採用



## 基本的な使い方
- pydanticをインポートする
- `BaseModel`を継承したくらすで、バリデーションを行う型定義をする

    ```python
    from datetime import datetime
    from typing import List

    from pydantic import BaseModel


    # pydantic.BaseModelを継承する
    class User(BaseModel):
        id: int
        name: str  # (変数):(型)として、型を宣言する
        friends: List[int] = []  # "=" を利用してデフォルト値を定義することもできます
        created_at: datetime
    ```


- `try except`でバリデーションチェックを行う
- 下記の例は、バリデーションチェックOKの場合
    ```python
    # チェックをしたいデータ構造
    external_data = {
        'id': 1,
        'name': 'TestUser',
        'friends': [114, 514],
        'created_at': '2019-11-03 03:34'
    }


    # チェックしたいデータ構造をクラスに当てはめて型チェック。NGならエエラー
    try:
        user = User(**external_data)
    except ValueError as e:
        print(e.json())

    print('')
    print(user.id)
    print(type(user.id))

    print('')
    print(user.created_at)
    print(type(user.created_at))

    print('')
    print(user.friends)
    print(type(user.friends))

    print('')
    print(user.dict())
    print(type(user.dict()))
    ```
    ```sh:実行結果
    1
    <class 'int'>

    2019-11-03 03:34:00
    <class 'datetime.datetime'>

    [114, 514]
    <class 'list'>

    {'id': 1, 'name': 'TestUser', 'friends': [114, 514], 'created_at': datetime.datetime(2019, 11, 3, 3, 34)}
    <class 'dict'>
    ```
    
    
- 下記の例は、バリデーションチェックNGの場合

    ```python
    external_data = {
        'id': 1,
        'name': 'TestUser',
        'friends': {'X': 114, 'Y': 514},
        'created_at': '2020年07月'
    }

    # 基本的な使い方
    try:
        user = User(**external_data)
    except ValueError as e:
        print(e.json())
    ```
    ```sh:実行結果
    [
      {
        "loc": [
          "friends"
        ],
        "msg": "value is not a valid list",
        "type": "type_error.list"
      },
      {
        "loc": [
          "created_at"
        ],
        "msg": "invalid datetime format",
        "type": "value_error.datetime"
      }
    ]
    ```
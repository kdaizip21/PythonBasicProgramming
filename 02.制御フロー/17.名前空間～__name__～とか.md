# globals()

グローバル変数で定義されているものは`globals()`で取り出すことができる


```python
import pprint

# pprintは出力結果を見やすく整列するだけ
pprint.pprint(globals())
```

```
{'__annotations__': {},
 '__builtins__': <module 'builtins' (built-in)>,
 '__cached__': None,
 '__doc__': None,
 '__file__': 'F:/Develop/Python/lesson/lesson.py',
 '__loader__': <_frozen_importlib_external.SourceFileLoader object at 0x000001B58A53DF08>,
 '__name__': '__main__',
 '__package__': None,
 '__spec__': None,
 'pprint': <module 'pprint' from 'C:\\Python\\Python37\\lib\\pprint.py'>}
 ```
 
 - このファイルでグローバルで定義されるものが全てここに出てくる
 - よくある`__name__`はここにある
 
 - `__doc__`はDocstringを定義すると出てくる
 ```python
"""
Doc Test
"""
import pprint
pprint.pprint(globals())
```

```
{'__annotations__': {},
 '__builtins__': <module 'builtins' (built-in)>,
 '__cached__': None,
 '__doc__': '\nDoc Test\n',
 '__file__': 'F:/Develop/Python/lesson/lesson.py',
 '__loader__': <_frozen_importlib_external.SourceFileLoader object at 0x0000027BB3B2DF08>,
 '__name__': '__main__',
 '__package__': None,
 '__spec__': None,
 'pprint': <module 'pprint' from 'C:\\Python\\Python37\\lib\\pprint.py'>}
```
 
 
 # よくある`if __name__ == "__main__" `
 
 よくある実行ファイルの書き方
 
 ```python
 def func1:
    xxxxxxxxx


def func2:
    yyyyyyyy


def main():
    func1()
    func2()


if __name__ == '__main__':
    main()
```
 
これは、
 - このファイルの`__name__`が`__main__`のときだけ`main()`を実行する
 - この書き方が一般的であることを抑えておけば良い


# 以下モジュールの概念が分かっている人用の説明


## サンプル
 
1.  一つの`main()`と一つのライブラリ`mylibs`があり
2.  どちらも`globles()`を実行する


```
 .
├── main.py
└── mylibs
    ├── __init__.py
    └── printg.py
 ```

### ソースコード

- `main.py`

    ```python
    import mylibs.printg as myl
    import pprint

    def main():
        # モジュール側のglobal()を実行
        print('# モジュール側のglobals()')
        myl.global_prints.global_print()

		
        # main.py側のglobals()を実行
        print('# main関数側のglobals()')
        pprint.pprint(globals())

    if __name__ == '__main__':
        main()
    ```
    
    
- `printg.py`
    ```python
    import pprint

    class global_prints:
        def global_print():
            pprint.pprint(globals())
    ```
 
 ### 実行結果
```
# モジュール側のglobals()

{'   ～ 略 ～
 '__file__': 'F:\\Develop\\Python\\lesson\\venv\\mylibs\\printg.py',
 '__name__': 'mylibs.printg',
 '__package__': 'mylibs',
 'global_prints': <class 'mylibs.printg.global_prints'>,
 'pprint': <module 'pprint' from 'C:\\Python\\Python37\\lib\\pprint.py'>}


# main関数側のglobals()

{'__annotations__': {},
 '__file__': 'F:\\Develop\\Python\\lesson\\main.py',
 '__name__': '__main__',
 '__package__': None,
 '__spec__': None,
 'main': <function main at 0x000002264000D1F8>,
 'myl': <module 'mylibs.printg' from 'F:\\Develop\\Python\\lesson\\venv\\mylibs\\printg.py'>,
 'pprint': <module 'pprint' from 'C:\\Python\\Python37\\lib\\pprint.py'>}
 ```
 
実行した場所によって`__name__`が変わることがわかる。


 

```python
if __name__ == '__main__':
    main()
```

これがなく

```python
main()
```

だけだった場合、    
- `main.py`を誰かが呼び出した瞬間に`main()`が実行されてしまう     
- それを避けるために`__name__`に条件を持つ
- さらにclass側は自分自身が `mylibs.printg`だった場合に実行可能なような設定を行う
    - これは`__init__.py`で定義する。（説明は別途）
 
 
 
 